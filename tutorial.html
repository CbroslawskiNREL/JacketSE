<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5. Tutorial &mdash; jacketse 1.0. documentation</title>
    
    <link rel="stylesheet" href="_static/nrel.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="jacketse 1.0. documentation" href="index.html" />
    <link rel="prev" title="4. Theory" href="theory.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="theory.html" title="4. Theory"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">jacketse 1.0. documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tutorial">
<h1>5. Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>Two examples are included in this tutorial section: simulation of a jacket-tower, and optimization of a jacket-tower support structure.</p>
<div class="section" id="mw-jacket-tower-in-30-m-waters">
<h2>5.1. 5-MW Jacket Tower in 30 m Waters<a class="headerlink" href="#mw-jacket-tower-in-30-m-waters" title="Permalink to this headline">¶</a></h2>
<p>This example demonstrates how to setup and run <em>analysis</em> for a jacket-tower support structure.
The structure looks as shown in <a href="tutorial.html">Figure jacketTut-fig</a><tt class="xref num docutils literal"><span class="pre">Figure</span> <span class="pre">jacketTut-fig</span></tt> :</p>
<div class="figure align-center" id="jackettut-fig">
<a class="reference internal image-reference" href="_images/jacket_tower_tut.png"><img alt="_images/jacket_tower_tut.png" src="_images/jacket_tower_tut.png" style="width: 6in;" /></a>
<p class="caption">Figure 1: Figure 1: Jacket-tower structure for the tutorial example.</p>
</div>
<p>First, we set up the jacket geometry parameters:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">Jcktins</span><span class="o">=</span><span class="n">JcktGeoInputs</span><span class="p">()</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">nlegs</span> <span class="o">=</span><span class="mi">4</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">nbays</span> <span class="o">=</span><span class="mi">5</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">batter</span><span class="o">=</span><span class="mf">12.</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">dck_botz</span> <span class="o">=</span><span class="mf">16.</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">dck_width</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="mf">6.</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">weld2D</span>   <span class="o">=</span><span class="mf">0.5</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">VPFlag</span> <span class="o">=</span> <span class="bp">True</span>    <span class="c">#vertical pile T/F;  to enable piles in frame3DD set pileinputs.ndiv&gt;0</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">clamped</span><span class="o">=</span> <span class="bp">False</span>    <span class="c">#whether or not the bottom of the structure is rigidly connected. Use False when equivalent spring constants are being used.</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">AFflag</span> <span class="o">=</span> <span class="bp">False</span>  <span class="c">#whether or not to use apparent fixity piles</span>
    <span class="n">Jcktins</span><span class="o">.</span><span class="n">PreBuildTPLvl</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c">#if &gt;0, the TP is prebuilt according to rules per PreBuildTP</span>
</pre></div>
</div>
<p>Then we set up various component inputs. Start with the soil stratigraphy:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">Soilinputs</span><span class="o">=</span><span class="n">SoilGeoInputs</span><span class="p">()</span>
    <span class="n">Soilinputs</span><span class="o">.</span><span class="n">zbots</span>   <span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.</span><span class="p">,</span><span class="mf">5.</span><span class="p">,</span><span class="mf">7.</span><span class="p">,</span><span class="mf">15.</span><span class="p">,</span><span class="mf">30.</span><span class="p">,</span><span class="mf">50.</span><span class="p">])</span>
    <span class="n">Soilinputs</span><span class="o">.</span><span class="n">gammas</span>  <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10000.</span><span class="p">,</span><span class="mf">10000.</span><span class="p">,</span><span class="mf">10000.</span><span class="p">,</span><span class="mf">10000.</span><span class="p">,</span><span class="mf">10000.</span><span class="p">,</span><span class="mf">10000.</span><span class="p">])</span>
    <span class="n">Soilinputs</span><span class="o">.</span><span class="n">cus</span>     <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">60000.</span><span class="p">,</span><span class="mf">60000.</span><span class="p">,</span><span class="mf">60000.</span><span class="p">,</span><span class="mf">60000.</span><span class="p">,</span><span class="mf">60000.</span><span class="p">,</span><span class="mf">60000.</span><span class="p">])</span>
    <span class="n">Soilinputs</span><span class="o">.</span><span class="n">phis</span>    <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">26.</span><span class="p">,</span><span class="mf">26.</span><span class="p">,</span><span class="mf">26.</span><span class="p">,</span><span class="mf">26.</span><span class="p">,</span><span class="mf">26.</span><span class="p">,</span><span class="mi">26</span><span class="p">])</span><span class="c">#np.array([36.,33.,26.,37.,35.,37.5])#np.array([36.,33.,26.,37.,35.,37.5])</span>
    <span class="n">Soilinputs</span><span class="o">.</span><span class="n">delta</span>   <span class="o">=</span><span class="mf">25.</span>
    <span class="n">Soilinputs</span><span class="o">.</span><span class="n">sndflg</span>   <span class="o">=</span><span class="bp">True</span>
    <span class="n">Soilinputs</span><span class="o">.</span><span class="n">PenderSwtch</span>   <span class="o">=</span><span class="bp">False</span> <span class="c">#True</span>
    <span class="n">Soilinputs</span><span class="o">.</span><span class="n">SoilSF</span>   <span class="o">=</span><span class="mf">1.</span>
</pre></div>
</div>
<p>Then assign water and wind environmental parameters:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">Waterinputs</span><span class="o">=</span><span class="n">WaterInputs</span><span class="p">()</span>
    <span class="n">Waterinputs</span><span class="o">.</span><span class="n">wdepth</span>   <span class="o">=</span><span class="mf">30.</span>
    <span class="n">Waterinputs</span><span class="o">.</span><span class="n">wlevel</span>   <span class="o">=</span><span class="mf">30.</span> <span class="c">#Distance from bottom of structure to surface  THIS, I believe is no longer needed as piles may be negative in z, to check and remove in case</span>
    <span class="n">Waterinputs</span><span class="o">.</span><span class="n">T</span><span class="o">=</span><span class="mf">12.</span>  <span class="c">#Wave Period</span>
    <span class="n">Waterinputs</span><span class="o">.</span><span class="n">HW</span><span class="o">=</span><span class="mf">10.</span> <span class="c">#Wave Height</span>
    <span class="n">Waterinputs</span><span class="o">.</span><span class="n">Cd</span><span class="o">=</span><span class="mf">3.</span>  <span class="c">#Drag Coefficient, enhanced to account for marine growth and other members not calculated</span>
    <span class="n">Waterinputs</span><span class="o">.</span><span class="n">Cm</span><span class="o">=</span><span class="mf">8.</span><span class="c">#2.  #ADded mass Coefficient</span>

    <span class="n">Windinputs</span><span class="o">=</span><span class="n">WindInputs</span><span class="p">()</span>
    <span class="n">Windinputs</span><span class="o">.</span><span class="n">Cdj</span><span class="o">=</span><span class="mf">4.</span>  <span class="c">#Drag Coefficient for jacket members, enhanced to account for TP drag not calculated otherwise</span>
    <span class="n">Windinputs</span><span class="o">.</span><span class="n">Cdt</span><span class="o">=</span><span class="mi">2</span>  <span class="c">#Drag Coefficient for tower, enhanced to account for TP drag not calculated otherwise</span>
    <span class="n">Windinputs</span><span class="o">.</span><span class="n">HH</span><span class="o">=</span><span class="mf">100.</span> <span class="c">#CHECK HOW THIS COMPLIES....</span>
    <span class="n">Windinputs</span><span class="o">.</span><span class="n">U50HH</span><span class="o">=</span><span class="mf">30.</span> <span class="c">#assumed gust speed</span>
</pre></div>
</div>
<p>Now it is time to assign properties for the various member classes of the structure.</p>
<p>We will follow a bottom up approach, where the definitions are offered from the bottom members towards the top ones.</p>
<p>Start with the piles:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">Pilematin</span><span class="o">=</span><span class="n">MatInputs</span><span class="p">()</span>
    <span class="n">Pilematin</span><span class="o">.</span><span class="n">matname</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;steel&#39;</span><span class="p">])</span>
    <span class="n">Pilematin</span><span class="o">.</span><span class="n">E</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">25.e9</span><span class="p">])</span>
    <span class="n">Dpile</span><span class="o">=</span><span class="mf">2.5</span><span class="c">#0.75 # 2.0</span>
    <span class="n">tpile</span><span class="o">=</span><span class="mf">0.01</span>
    <span class="n">Lp</span><span class="o">=</span><span class="mf">20.</span> <span class="c">#45</span>

    <span class="n">Pileinputs</span><span class="o">=</span><span class="n">PileGeoInputs</span><span class="p">()</span>
    <span class="n">Pileinputs</span><span class="o">.</span><span class="n">Pilematins</span><span class="o">=</span><span class="n">Pilematin</span>
    <span class="n">Pileinputs</span><span class="o">.</span><span class="n">ndiv</span><span class="o">=</span><span class="mi">0</span> <span class="c">#3</span>
    <span class="n">Pileinputs</span><span class="o">.</span><span class="n">Dpile</span><span class="o">=</span><span class="n">Dpile</span>
    <span class="n">Pileinputs</span><span class="o">.</span><span class="n">tpile</span><span class="o">=</span><span class="n">tpile</span>
    <span class="n">Pileinputs</span><span class="o">.</span><span class="n">Lp</span><span class="o">=</span><span class="n">Lp</span> <span class="c">#[m] Embedment length</span>
</pre></div>
</div>
<p>Then continue with the main legs:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">legmatin</span><span class="o">=</span><span class="n">MatInputs</span><span class="p">()</span>
    <span class="n">legmatin</span><span class="o">.</span><span class="n">matname</span><span class="o">=</span><span class="p">([</span><span class="s">&#39;heavysteel&#39;</span><span class="p">,</span><span class="s">&#39;heavysteel&#39;</span><span class="p">,</span><span class="s">&#39;heavysteel&#39;</span><span class="p">,</span><span class="s">&#39;heavysteel&#39;</span><span class="p">])</span>
    <span class="c">#legmatin.E=np.array([2.0e11])</span>
    <span class="n">Dleg</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">])</span>
    <span class="n">tleg</span><span class="o">=</span><span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0254</span><span class="p">])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">Dleg</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="n">leginputs</span><span class="o">=</span><span class="n">LegGeoInputs</span><span class="p">()</span>
    <span class="n">leginputs</span><span class="o">.</span><span class="n">legZbot</span>   <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">leginputs</span><span class="o">.</span><span class="n">ndiv</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">leginputs</span><span class="o">.</span><span class="n">legmatins</span><span class="o">=</span><span class="n">legmatin</span>
    <span class="n">leginputs</span><span class="o">.</span><span class="n">Dleg</span><span class="o">=</span><span class="n">Dleg</span>
    <span class="n">leginputs</span><span class="o">.</span><span class="n">tleg</span><span class="o">=</span><span class="n">tleg</span>

    <span class="n">legbot_stmphin</span> <span class="o">=</span><span class="mf">1.5</span>  <span class="c">#Distance from bottom of leg to second joint along z; must be&gt;0</span>
</pre></div>
</div>
<p>Then move on to the X-braces:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">Xbrcmatin</span><span class="o">=</span><span class="n">MatInputs</span><span class="p">()</span>
    <span class="n">Xbrcmatin</span><span class="o">.</span><span class="n">matname</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;heavysteel&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">Jcktins</span><span class="o">.</span><span class="n">nbays</span><span class="p">)</span>
    <span class="c">#Xbrcmatin.E=np.array([ 2.2e11, 2.0e11,2.0e11,2.0e11,2.0e11])</span>
    <span class="n">Dbrc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
    <span class="n">tbrc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span><span class="o">*</span><span class="mf">0.0254</span>

    <span class="n">Xbrcinputs</span><span class="o">=</span><span class="n">XBrcGeoInputs</span><span class="p">()</span>
    <span class="n">Xbrcinputs</span><span class="o">.</span><span class="n">Dbrc</span><span class="o">=</span><span class="n">Dbrc</span>
    <span class="n">Xbrcinputs</span><span class="o">.</span><span class="n">tbrc</span><span class="o">=</span><span class="n">tbrc</span>
    <span class="n">Xbrcinputs</span><span class="o">.</span><span class="n">ndiv</span><span class="o">=</span><span class="mi">2</span><span class="c">#2</span>
    <span class="n">Xbrcinputs</span><span class="o">.</span><span class="n">Xbrcmatins</span><span class="o">=</span><span class="n">Xbrcmatin</span>
    <span class="n">Xbrcinputs</span><span class="o">.</span><span class="n">precalc</span><span class="o">=</span><span class="bp">False</span> <span class="c">#True   #This can be set to true if we want Xbraces to be precalculated in D and t, in which case the above set Dbrc and tbrc would be overwritten</span>
</pre></div>
</div>
<p>In this example we are considering the Mud-braces. They normally mitigate stress concentrations at the pile-leg connections and provide some torsional stiffness:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">Mbrcmatin</span><span class="o">=</span><span class="n">MatInputs</span><span class="p">()</span>
    <span class="n">Mbrcmatin</span><span class="o">.</span><span class="n">matname</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;heavysteel&#39;</span><span class="p">])</span>
    <span class="c">#Mbrcmatin.E=np.array([ 2.5e11])</span>
    <span class="n">Dbrc_mud</span><span class="o">=</span><span class="mf">1.5</span>

    <span class="n">Mbrcinputs</span><span class="o">=</span><span class="n">MudBrcGeoInputs</span><span class="p">()</span>
    <span class="n">Mbrcinputs</span><span class="o">.</span><span class="n">Dbrc_mud</span><span class="o">=</span><span class="n">Dbrc_mud</span>
    <span class="n">Mbrcinputs</span><span class="o">.</span><span class="n">ndiv</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">Mbrcinputs</span><span class="o">.</span><span class="n">Mbrcmatins</span><span class="o">=</span><span class="n">Mbrcmatin</span>
    <span class="n">Mbrcinputs</span><span class="o">.</span><span class="n">precalc</span><span class="o">=</span><span class="bp">False</span> <span class="c">#True   #This can be set to true if we want Mudbrace to be precalculated in D and t, in which case the above set Dbrc_mud and tbrc_mud would be overwritten</span>
</pre></div>
</div>
<p>In this case we are not considering a top horizontal brace below the main perimeter girder of the TP, so we will set its <em>ndiv</em> to 0:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">Hbrcmatin</span><span class="o">=</span><span class="n">MatInputs</span><span class="p">()</span>
    <span class="n">Hbrcmatin</span><span class="o">.</span><span class="n">matname</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;heavysteel&#39;</span><span class="p">])</span>
    <span class="n">Hbrcmatin</span><span class="o">.</span><span class="n">E</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">2.5e11</span><span class="p">])</span>
    <span class="n">Dbrc_hbrc</span><span class="o">=</span><span class="mf">1.1</span>

    <span class="n">Hbrcinputs</span><span class="o">=</span><span class="n">HBrcGeoInputs</span><span class="p">()</span>
    <span class="n">Hbrcinputs</span><span class="o">.</span><span class="n">Dbrch</span><span class="o">=</span><span class="n">Dbrc_hbrc</span>
    <span class="n">Hbrcinputs</span><span class="o">.</span><span class="n">ndiv</span><span class="o">=</span><span class="mi">0</span><span class="c">#2</span>
    <span class="n">Hbrcinputs</span><span class="o">.</span><span class="n">Hbrcmatins</span><span class="o">=</span><span class="n">Hbrcmatin</span>
    <span class="n">Hbrcinputs</span><span class="o">.</span><span class="n">precalc</span><span class="o">=</span><span class="bp">True</span>   <span class="c">#This can be set to true if we want Hbrace to be set=Xbrace top D and t, in which case the above set Dbrch and tbrch would be overwritten</span>
</pre></div>
</div>
<p>The next step consists of declaring the transition piece properties.</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">TPlumpinputs</span><span class="o">=</span><span class="n">TPlumpMass</span><span class="p">()</span>
    <span class="n">TPlumpinputs</span><span class="o">.</span><span class="n">mass</span><span class="o">=</span><span class="mf">200.e3</span> <span class="c">#[kg]</span>

    <span class="n">TPstmpsmatin</span><span class="o">=</span><span class="n">MatInputs</span><span class="p">()</span>
    <span class="n">TPbrcmatin</span><span class="o">=</span><span class="n">MatInputs</span><span class="p">()</span>
    <span class="n">TPstemmatin</span><span class="o">=</span><span class="n">MatInputs</span><span class="p">()</span>
    <span class="n">TPbrcmatin</span><span class="o">.</span><span class="n">matname</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;heavysteel&#39;</span><span class="p">])</span>
    <span class="c">#TPbrcmatin.E=np.array([ 2.5e11])</span>
    <span class="n">TPstemmatin</span><span class="o">.</span><span class="n">matname</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;heavysteel&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="c">#TPstemmatin.E=np.array([ 2.1e11]).repeat(2)</span>

    <span class="n">TPinputs</span><span class="o">=</span><span class="n">TPGeoInputs</span><span class="p">()</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">TPbrcmatins</span><span class="o">=</span><span class="n">TPbrcmatin</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">TPstemmatins</span><span class="o">=</span><span class="n">TPstemmatin</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">TPstmpmatins</span><span class="o">=</span><span class="n">TPstmpsmatin</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">Dstrut</span><span class="o">=</span><span class="n">leginputs</span><span class="o">.</span><span class="n">Dleg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">tstrut</span><span class="o">=</span><span class="n">leginputs</span><span class="o">.</span><span class="n">tleg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">Dgir</span><span class="o">=</span><span class="n">Dbrc_hbrc</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">tgir</span><span class="o">=</span><span class="mf">0.0254</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">Dbrc</span><span class="o">=</span><span class="mf">1.1</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">Dbrc</span><span class="o">=</span><span class="n">TPinputs</span><span class="o">.</span><span class="n">Dgir</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">tbrc</span><span class="o">=</span><span class="n">TPinputs</span><span class="o">.</span><span class="n">tgir</span>

    <span class="n">TPinputs</span><span class="o">.</span><span class="n">hstump</span><span class="o">=</span><span class="mf">0.0</span><span class="c">#1.0</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">stumpndiv</span><span class="o">=</span><span class="mi">1</span><span class="c">#2</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">brcndiv</span><span class="o">=</span><span class="mi">1</span><span class="c">#2</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">girndiv</span><span class="o">=</span><span class="mi">1</span><span class="c">#2</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">strutndiv</span><span class="o">=</span><span class="mi">1</span><span class="c">#2</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">stemndiv</span><span class="o">=</span><span class="mi">1</span><span class="c">#2</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">nstems</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">Dstem</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.</span><span class="p">])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">TPinputs</span><span class="o">.</span><span class="n">nstems</span><span class="p">)</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">tstem</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">0.11</span><span class="p">])</span>
    <span class="n">TPinputs</span><span class="o">.</span><span class="n">hstem</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">6.</span><span class="o">/</span><span class="n">TPinputs</span><span class="o">.</span><span class="n">nstems</span><span class="p">])</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">TPinputs</span><span class="o">.</span><span class="n">nstems</span><span class="p">)</span>
</pre></div>
</div>
<p>Then the tower geometry is assigned:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">Twrmatin</span><span class="o">=</span><span class="n">MatInputs</span><span class="p">()</span>
    <span class="n">Twrmatin</span><span class="o">.</span><span class="n">matname</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s">&#39;heavysteel&#39;</span><span class="p">])</span>
    <span class="c">#Twrmatin.E=np.array([ 2.77e11])</span>
    <span class="n">Twrinputs</span><span class="o">=</span><span class="n">TwrGeoInputs</span><span class="p">()</span>
    <span class="n">Twrinputs</span><span class="o">.</span><span class="n">Twrmatins</span><span class="o">=</span><span class="n">Twrmatin</span>
    <span class="c">#Twrinputs.Htwr=70.  #Trumped by HH</span>
    <span class="n">Twrinputs</span><span class="o">.</span><span class="n">Htwr2frac</span><span class="o">=</span><span class="mf">0.2</span>   <span class="c">#fraction of tower height with constant x-section</span>
    <span class="n">Twrinputs</span><span class="o">.</span><span class="n">ndiv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>  <span class="c">#ndiv for uniform and tapered section</span>
    <span class="n">Twrinputs</span><span class="o">.</span><span class="n">DeltaZmax</span><span class="o">=</span> <span class="mf">6.</span> <span class="c">#[m], maximum FE element length allowed in the tower members (i.e. the uniform and the tapered members)</span>
    <span class="n">Twrinputs</span><span class="o">.</span><span class="n">Db</span><span class="o">=</span><span class="mf">5.6</span>
    <span class="n">Twrinputs</span><span class="o">.</span><span class="n">DTRb</span><span class="o">=</span><span class="mf">130.</span>
    <span class="n">Twrinputs</span><span class="o">.</span><span class="n">DTRt</span><span class="o">=</span><span class="mf">150.</span>
    <span class="n">Twrinputs</span><span class="o">.</span><span class="n">Dt</span><span class="o">=</span><span class="mf">0.55</span><span class="o">*</span><span class="n">Twrinputs</span><span class="o">.</span><span class="n">Db</span>
</pre></div>
</div>
<p>Then the RNA mass properties are specified:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">RNA_F</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1000.e3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
<p>Then assign the RNA aerodynamic loads:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">RNA_F</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1000.e3</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
<p>Finally auxiliary parameters for the Frame3DD solver may be assigned:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">FrameAuxIns</span><span class="o">=</span><span class="n">Frame3DDaux</span><span class="p">()</span>
    <span class="n">FrameAuxIns</span><span class="o">.</span><span class="n">sh_fg</span><span class="o">=</span><span class="mi">1</span>               <span class="c">#shear flag--&gt;Timoshenko</span>
    <span class="n">FrameAuxIns</span><span class="o">.</span><span class="n">deltaz</span><span class="o">=</span><span class="mf">5.</span>
    <span class="n">FrameAuxIns</span><span class="o">.</span><span class="n">geo_fg</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">FrameAuxIns</span><span class="o">.</span><span class="n">nModes</span> <span class="o">=</span> <span class="mi">6</span>             <span class="c"># number of desired dynamic modes of vibration</span>
    <span class="n">FrameAuxIns</span><span class="o">.</span><span class="n">Mmethod</span> <span class="o">=</span> <span class="mi">1</span>            <span class="c"># 1: subspace Jacobi     2: Stodola</span>
    <span class="n">FrameAuxIns</span><span class="o">.</span><span class="n">lump</span> <span class="o">=</span> <span class="mi">0</span>               <span class="c"># 0: consistent mass ... 1: lumped mass matrix</span>
    <span class="n">FrameAuxIns</span><span class="o">.</span><span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-9</span>             <span class="c"># mode shape tolerance</span>
    <span class="n">FrameAuxIns</span><span class="o">.</span><span class="n">shift</span> <span class="o">=</span> <span class="mf">0.0</span>            <span class="c"># shift value ... for unrestrained structures</span>
    <span class="n">FrameAuxIns</span><span class="o">.</span><span class="n">gvector</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="o">-</span><span class="mf">9.8065</span><span class="p">])</span>    <span class="c">#GRAVITY</span>
</pre></div>
</div>
<p>It is then time to launch the assembly and pass all the inputs to it; note that the assembly is called with parameters depending on the selected inputs:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">myjckt</span><span class="o">=</span><span class="n">set_as_top</span><span class="p">(</span><span class="n">JacketSE</span><span class="p">(</span><span class="n">Jcktins</span><span class="o">.</span><span class="n">clamped</span><span class="p">,</span><span class="n">Jcktins</span><span class="o">.</span><span class="n">AFflag</span><span class="p">,(</span><span class="n">Jcktins</span><span class="o">.</span><span class="n">PreBuildTPLvl</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)))</span>

    <span class="c">#Pass all inputs to assembly</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">JcktGeoIn</span><span class="o">=</span><span class="n">Jcktins</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">Soilinputs</span><span class="o">=</span><span class="n">Soilinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">Waterinputs</span><span class="o">=</span><span class="n">Waterinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">Windinputs</span><span class="o">=</span><span class="n">Windinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">RNA_F</span><span class="o">=</span><span class="n">RNA_F</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">Pileinputs</span><span class="o">=</span><span class="n">Pileinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">leginputs</span><span class="o">=</span><span class="n">leginputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">legbot_stmphin</span> <span class="o">=</span><span class="n">legbot_stmphin</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">Xbrcinputs</span><span class="o">=</span><span class="n">Xbrcinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">Mbrcinputs</span><span class="o">=</span><span class="n">Mbrcinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">Hbrcinputs</span><span class="o">=</span><span class="n">Hbrcinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">TPlumpinputs</span><span class="o">=</span><span class="n">TPlumpinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">TPinputs</span><span class="o">=</span><span class="n">TPinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">RNAinputs</span><span class="o">=</span><span class="n">RNAins</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">Twrinputs</span><span class="o">=</span><span class="n">Twrinputs</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">TwrRigidTop</span><span class="o">=</span><span class="n">TwrRigidTop</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">FrameAuxIns</span><span class="o">=</span><span class="n">FrameAuxIns</span>
</pre></div>
</div>
<p>Then run the assembly:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">myjckt</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>You may print some of the results of the analysis:</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="k">print</span><span class="p">(</span><span class="s">&#39;First two Freqs.= {:5.4f} and {:5.4f} Hz&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">Freqs</span><span class="p">))</span>
    <span class="c">#print component masses</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;jacket+TP(structural+lumped) mass (no tower, no piles) [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPlumpinputs</span><span class="o">.</span><span class="n">mass</span><span class="o">-</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Tower</span><span class="o">.</span><span class="n">Twrouts</span><span class="o">.</span><span class="n">mass</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;tower mass [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Tower</span><span class="o">.</span><span class="n">Twrouts</span><span class="o">.</span><span class="n">mass</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;TP mass structural + lumped mass [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPouts</span><span class="o">.</span><span class="n">mass</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPlumpinputs</span><span class="o">.</span><span class="n">mass</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;piles (all) mass for assigned (not optimum, unless optimization is run) Lp [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Mpiles</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;frame3dd model mass (structural + TP lumped) [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPlumpinputs</span><span class="o">.</span><span class="n">mass</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;frame3dd model mass (structural + TP lumped) + Pile Mass [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPlumpinputs</span><span class="o">.</span><span class="n">mass</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Mpiles</span><span class="p">))</span>

    <span class="c">#print tower top displacement</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Tower Top Displacement in Global Coordinate System [m] ={:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">top_deflection</span><span class="p">))</span>
    <span class="c">#print max API code checks</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;MAX member compression-bending utilization at joints = {:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">jacket_utilization</span><span class="o">.</span><span class="n">cb_util</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;MAX member tension utilization at joints = {:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">jacket_utilization</span><span class="o">.</span><span class="n">t_util</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;MAX X-joint  utilization at joints = {:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">jacket_utilization</span><span class="o">.</span><span class="n">XjntUtil</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;MAX K-joint  utilization at joints = {:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">jacket_utilization</span><span class="o">.</span><span class="n">KjntUtil</span><span class="p">)))</span>
</pre></div>
</div>
<p>They should look as shown here:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;7 nodes in the constant-OD segment of the tower</span>
<span class="go">&gt;&gt;&gt;(&#39;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  needed embedment Lp0=&#39;, 29.499564957098116)</span>
<span class="go">&gt;&gt;&gt;First two Freqs.= 0.1983 and 0.1994 Hz</span>
<span class="go">&gt;&gt;&gt;jacket+TP(structural+lumped) mass (no tower, no piles) [kg] = 1154582</span>
<span class="go">&gt;&gt;&gt;tower mass [kg] = 335018</span>
<span class="go">&gt;&gt;&gt;TP mass structural + lumped mass [kg] = 335354</span>
<span class="go">&gt;&gt;&gt;piles (all) mass (for assigned (not optimum) Lp [kg] =  48844</span>
<span class="go">&gt;&gt;&gt;frame3dd model mass (structural + TP lumped) [kg] = 1489600</span>
<span class="go">&gt;&gt;&gt;Tower Top Displacement in Global Coordinate System [m] =0.4843</span>
<span class="go">&gt;&gt;&gt;MAX member compression-bending utilization at joints = 0.5608</span>
<span class="go">&gt;&gt;&gt;MAX member tension utilization at joints = 0.6413</span>
<span class="go">&gt;&gt;&gt;MAX X-joint  utilization at joints = 0.2600</span>
<span class="go">&gt;&gt;&gt;MAX K-joint  utilization at joints = 0.3667</span>
</pre></div>
</div>
<p>If you plot the utilization of the tower, you should get something as in <a class="pageref" href="#utilization-fig">Figure  2</a>, where
the Von Mises stress, global and shell buckling utilizations are shown along the tower span.  Each curve represents material utilization and so should be &lt;1 for feasibility.</p>
<div class="figure align-center" id="utilization-fig">
<a class="reference internal image-reference" href="_images/util_tut.png"><img alt="_images/util_tut.png" src="_images/util_tut.png" style="width: 6in;" /></a>
<p class="caption">Figure 2: Figure 2: Utilization along tower height for: Von-Mises/yield; shell buckling; global buckling.</p>
</div>
</div>
<div class="section" id="jacket-tower-optimization-openmdao-internal-optimization-driver">
<span id="mdaosnopt-label"></span><h2>5.2. Jacket-Tower Optimization - OpenMDAO Internal Optimization Driver<a class="headerlink" href="#jacket-tower-optimization-openmdao-internal-optimization-driver" title="Permalink to this headline">¶</a></h2>
<p>We begin with the same setup as the previous section, but now we need to set up the optimizer and thus also offer bounds for the design variables:</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="c">#          x=  [ batter,  Dpile,    tpile,   Lp,   Dleg,     tleg,       Dbrc,   tbrc,     Dbrc_mud,   tbrc_mud,    Db,   DTRb   Dt,   DTRt   Htwr2fac ]</span>
        <span class="n">MnCnst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">8.</span><span class="p">,</span>      <span class="mf">1.</span><span class="p">,</span>    <span class="mf">1.</span><span class="o">*</span><span class="mf">0.0254</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>       <span class="mf">1.</span><span class="o">*</span><span class="mf">0.0254</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>    <span class="mf">1.</span><span class="o">*</span><span class="mf">0.0254</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>     <span class="mf">1.</span><span class="o">*</span><span class="mf">0.0254</span><span class="p">,</span>    <span class="mf">5.</span><span class="p">,</span>   <span class="mf">120.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>   <span class="mf">120.</span><span class="p">,</span>     <span class="mf">0.</span> <span class="p">])</span>
        <span class="n">MxCnst</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">15.</span><span class="p">,</span>     <span class="mf">2.5</span><span class="p">,</span>   <span class="mf">5.</span><span class="o">*</span><span class="mf">0.0254</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span>   <span class="mf">2.5</span><span class="p">,</span>      <span class="mf">5.</span><span class="o">*</span><span class="mf">0.0254</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>    <span class="mf">5.</span><span class="o">*</span><span class="mf">0.0254</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>     <span class="mf">5.</span><span class="o">*</span><span class="mf">0.0254</span><span class="p">,</span>    <span class="mf">7.</span><span class="p">,</span>   <span class="mf">200.</span><span class="p">,</span>  <span class="mf">4.</span><span class="p">,</span>   <span class="mf">200.</span><span class="p">,</span>   <span class="mf">0.25</span> <span class="p">])</span>
</pre></div>
</div>
<p>Also import additional modules for optimization:</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="kn">from</span> <span class="nn">pyopt_driver.pyopt_driver</span> <span class="kn">import</span> <span class="n">pyOptDriver</span>
        <span class="kn">from</span> <span class="nn">openmdao.lib.casehandlers.api</span> <span class="kn">import</span> <span class="n">DumpCaseRecorder</span>
</pre></div>
</div>
<p>The optimizer must first be selected and configured, in this example use SNOPT.</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="k">if</span> <span class="n">OPTswitch</span> <span class="o">==</span> <span class="s">&#39;cobyla&#39;</span><span class="p">:</span>
            <span class="n">myjckt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;driver&#39;</span><span class="p">,</span> <span class="n">COBYLAdriver</span><span class="p">())</span>

            <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">rhobeg</span><span class="o">=</span><span class="mf">0.01</span>
            <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">rhoend</span><span class="o">=</span><span class="mf">1.e-3</span>
            <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">maxfun</span><span class="o">=</span><span class="mi">2000</span>
            <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">iprint</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">myjckt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;driver&#39;</span><span class="p">,</span> <span class="n">pyOptDriver</span><span class="p">())</span>
            <span class="k">if</span>  <span class="n">OPTswitch</span><span class="o">==</span> <span class="s">&#39;pyoptsnopt&#39;</span><span class="p">:</span>
                <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s">&#39;SNOPT&#39;</span>
                <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Major feasibility tolerance&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span>
                                     <span class="s">&#39;Minor feasibility tolerance&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span>
                                     <span class="s">&#39;Major optimality tolerance&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span>
                                     <span class="s">&#39;Function precision&#39;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">}</span>
            <span class="k">elif</span> <span class="n">OPTswitch</span><span class="o">==</span> <span class="s">&#39;pyoptcobyla&#39;</span><span class="p">:</span>
                <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s">&#39;COBYLA&#39;</span>
                <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;RHOEND&#39;</span><span class="p">:</span><span class="mf">1.e-2</span><span class="p">,</span><span class="s">&#39;RHOEND&#39;</span><span class="p">:</span><span class="mf">1.e-3</span><span class="p">,</span><span class="s">&#39;MAXFUN&#39;</span><span class="p">:</span><span class="mi">2000</span><span class="p">,</span><span class="s">&#39;IPRINT&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&#39;Error: OPTSwitch must be set to &#39;&#39;Cobyla&#39;&#39;, &#39;&#39;pyoptsnopt&#39;&#39; or &#39;&#39;pyoptcobyla&#39;&#39;!!!&#39;</span><span class="p">)</span>
        <span class="c"># ----------------------</span>

        <span class="c"># --- Objective ---</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;(FrameOut.Frameouts_outs.mass[0]+Embedment.Mpiles)/1.e6&#39;</span><span class="p">)</span>
        <span class="c"># ----------------------</span>

        <span class="c"># --- Design Variables ---</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;JcktGeoIn.batter&#39;</span><span class="p">,</span>   <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Pileinputs.Dpile&#39;</span><span class="p">,</span>   <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Pileinputs.tpile&#39;</span><span class="p">,</span>   <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Pileinputs.Lp&#39;</span><span class="p">,</span>      <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;leginputs.Dleg[0]&#39;</span><span class="p">,</span>     <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;leginputs.tleg[0]&#39;</span><span class="p">,</span>     <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Xbrcinputs.Dbrc[0]&#39;</span><span class="p">,</span>    <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Xbrcinputs.tbrc[0]&#39;</span><span class="p">,</span>    <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Mbrcinputs.Dbrc_mud&#39;</span><span class="p">,</span><span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Mbrcinputs.tbrc_mud&#39;</span><span class="p">,</span><span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.Db&#39;</span><span class="p">,</span>       <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.DTRb&#39;</span><span class="p">,</span>     <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.Dt&#39;</span><span class="p">,</span>       <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.DTRt&#39;</span><span class="p">,</span>     <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.Htwr2frac&#39;</span><span class="p">,</span><span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span>

       <span class="c">#--- Constraints ---#</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;FrameOut.Frameouts_outs.Freqs[0] &gt;=0.22&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;max(Utilization.tower_utilization.GLUtil) &lt;=1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;max(Utilization.tower_utilization.EUshUtil) &lt;=1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Utilization.jacket_utilization.t_util &lt;=1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Utilization.jacket_utilization.cb_util &lt;=1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Utilization.jacket_utilization.KjntUtil &lt;= 1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Utilization.jacket_utilization.XjntUtil &lt;= 1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;wbase &lt;= 30.&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;leginputs.Dleg[0]/leginputs.tleg[0] &gt;= 22.&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Xbrcinputs.Dbrc[0]/Xbrcinputs.tbrc[0] &gt;= 22.&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Mbrcinputs.Dbrc_mud/Mbrcinputs.tbrc_mud &gt;= 22.&#39;</span><span class="p">)</span>
        <span class="c"># ----------------------</span>

        <span class="c"># --- recorder ---</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">recorders</span> <span class="o">=</span> <span class="p">[</span><span class="n">DumpCaseRecorder</span><span class="p">(</span><span class="s">&#39;optimization.dat&#39;</span><span class="p">)]</span>
        <span class="c"># ----------------------</span>

    <span class="c">#--- RUN JACKET ---#</span>
    <span class="n">myjckt</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="c"># ---------------</span>

    <span class="c">#_____________________________________#</span>
    <span class="c">#Now show results of modal analysis</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;First two Freqs.= {:5.4f} and {:5.4f} Hz&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">Freqs</span><span class="p">))</span>
    <span class="c">#print component masses</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;jacket+TP(structural+lumped) mass (no tower, no piles) [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPlumpinputs</span><span class="o">.</span><span class="n">mass</span><span class="o">-</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Tower</span><span class="o">.</span><span class="n">Twrouts</span><span class="o">.</span><span class="n">mass</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;tower mass [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Tower</span><span class="o">.</span><span class="n">Twrouts</span><span class="o">.</span><span class="n">mass</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;TP mass structural + lumped mass [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPouts</span><span class="o">.</span><span class="n">mass</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPlumpinputs</span><span class="o">.</span><span class="n">mass</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;piles (all) mass for assigned (not optimum, unless optimization is run) Lp [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Mpiles</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;frame3dd model mass (structural + TP lumped) [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPlumpinputs</span><span class="o">.</span><span class="n">mass</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;frame3dd model mass (structural + TP lumped) + Pile Mass [kg] = {:6.0f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">mass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TP</span><span class="o">.</span><span class="n">TPlumpinputs</span><span class="o">.</span><span class="n">mass</span><span class="o">+</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Mpiles</span><span class="p">))</span>

    <span class="c">#print tower top displacement</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Tower Top Displacement in Global Coordinate System [m] ={:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Frameouts</span><span class="o">.</span><span class="n">top_deflection</span><span class="p">))</span>
    <span class="c">#print max API code checks</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;MAX member compression-bending utilization at joints = {:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">jacket_utilization</span><span class="o">.</span><span class="n">cb_util</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;MAX member tension utilization at joints = {:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">jacket_utilization</span><span class="o">.</span><span class="n">t_util</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;MAX X-joint  utilization at joints = {:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">jacket_utilization</span><span class="o">.</span><span class="n">XjntUtil</span><span class="p">)))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;MAX K-joint  utilization at joints = {:5.4f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">jacket_utilization</span><span class="o">.</span><span class="n">KjntUtil</span><span class="p">)))</span>

    <span class="c">#Plot geometry</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">Axes3D</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
    <span class="n">nodes</span><span class="o">=</span><span class="n">myjckt</span><span class="o">.</span><span class="n">JcktGeoOut</span><span class="o">.</span><span class="n">nodes</span>  <span class="c">#coordinates</span>
    <span class="n">mems</span><span class="o">=</span><span class="n">myjckt</span><span class="o">.</span><span class="n">JcktGeoOut</span><span class="o">.</span><span class="n">mems</span>
    <span class="n">XYZ1</span><span class="o">=</span><span class="n">nodes</span><span class="p">[</span><span class="n">mems</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span>
    <span class="n">XYZ2</span><span class="o">=</span><span class="n">nodes</span><span class="p">[</span><span class="n">mems</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,:]</span>
    <span class="c">#ax.scatter(nodes[:,0],nodes[:,1],nodes[:,2])</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">nodes</span><span class="p">)</span>
    <span class="c">#ax.scatter(x,y,z)</span>
    <span class="n">Xs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">XYZ1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">XYZ2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span>
    <span class="n">Ys</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">XYZ1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">XYZ2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span>
    <span class="n">Zs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">XYZ1</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">XYZ2</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span>
    <span class="c">#ax.plot([XYZ1[1:5,0],XYZ2[1:5,0]],[XYZ1[1:5,1],XYZ2[1:5,1]],[XYZ1[1:5,2],XYZ2[1:5,2]])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">mems</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="c">#mems.shape[0])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">XYZ1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">XYZ2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]],[</span><span class="n">XYZ1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">XYZ2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[</span><span class="n">XYZ1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">XYZ2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">axisEqual3D</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="c">#    ax.set_aspect(&#39;equal&#39;)</span>
<span class="c">#    ax.auto_scale_xyz([min(XYZ1[:,0]),max(XYZ1[:,0])],[min(XYZ1[:,1]),max(XYZ1[:,1])],[min(XYZ1[:,2]),max(XYZ1[:,2])])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

   <span class="c">#Plot tower utilization</span>
    <span class="n">twr_zs</span><span class="o">=</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Tower</span><span class="o">.</span><span class="n">Twrouts</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="n">myjckt</span><span class="o">.</span><span class="n">TwrRigidTop</span><span class="p">]</span>
    <span class="n">twr_ds</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Tower</span><span class="o">.</span><span class="n">Twrouts</span><span class="o">.</span><span class="n">TwrObj</span><span class="o">.</span><span class="n">D</span><span class="p">,</span><span class="n">myjckt</span><span class="o">.</span><span class="n">Tower</span><span class="o">.</span><span class="n">Dt</span><span class="p">))</span>

    <span class="n">fig2</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>

    <span class="n">ax1</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">tower_utilization</span><span class="o">.</span><span class="n">StressUtil</span><span class="p">,</span><span class="n">twr_zs</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;VonMises Util&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">tower_utilization</span><span class="o">.</span><span class="n">GLUtil</span><span class="p">,</span><span class="n">twr_zs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;GL Util&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">myjckt</span><span class="o">.</span><span class="n">tower_utilization</span><span class="o">.</span><span class="n">EUshUtil</span><span class="p">,</span> <span class="n">twr_zs</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;EUsh Util&#39;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">twiny</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span><span class="c"># .axes(ax1.get_position(),frameon=False)</span>
    <span class="c">#hh2=plt.axes(&#39;Position&#39;, pos,&#39;NextPlot&#39;,&#39;Add&#39;,&#39;XtickLabel&#39;,&#39;&#39;,&#39;Xtick&#39;,[],frameon=False);</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">twr_ds</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">twr_zs</span><span class="p">,</span><span class="s">&#39;k&#39;</span><span class="p">);</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span> <span class="n">twr_ds</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">twr_zs</span><span class="p">,</span><span class="s">&#39;k&#39;</span><span class="p">);</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;utilization&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;height along tower (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c">##________________SAMPLE CALL from outside IDE________________##</span>
<span class="c">## python jacket.py True PyOPTSnopt</span>
<span class="c">##___________________________________________##</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>
</pre></div>
</div>
<p>We now set the objective, and in this example it is normalized to be of order 1 for better convergence behavior.</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;(FrameOut.Frameouts_outs.mass[0]+Embedment.Mpiles)/1.e6&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The batter,pile OD and thickness, Embedment Length, Leg OD and thickness, X-brace OD and thickness,Mud-brace OD and thickness,Tower base OD and DTR, tower-top OD and DTR, and height of constant cross-section segment are added as design variables.</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;JcktGeoIn.batter&#39;</span><span class="p">,</span>   <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Pileinputs.Dpile&#39;</span><span class="p">,</span>   <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Pileinputs.tpile&#39;</span><span class="p">,</span>   <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Pileinputs.Lp&#39;</span><span class="p">,</span>      <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;leginputs.Dleg[0]&#39;</span><span class="p">,</span>     <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;leginputs.tleg[0]&#39;</span><span class="p">,</span>     <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Xbrcinputs.Dbrc[0]&#39;</span><span class="p">,</span>    <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Xbrcinputs.tbrc[0]&#39;</span><span class="p">,</span>    <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Mbrcinputs.Dbrc_mud&#39;</span><span class="p">,</span><span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Mbrcinputs.tbrc_mud&#39;</span><span class="p">,</span><span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>  <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.Db&#39;</span><span class="p">,</span>       <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.DTRb&#39;</span><span class="p">,</span>     <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">11</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.Dt&#39;</span><span class="p">,</span>       <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">12</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.DTRt&#39;</span><span class="p">,</span>     <span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">13</span><span class="p">])</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;Twrinputs.Htwr2frac&#39;</span><span class="p">,</span><span class="n">low</span><span class="o">=</span><span class="n">MnCnst</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">high</span><span class="o">=</span><span class="n">MxCnst</span><span class="p">[</span><span class="mi">14</span><span class="p">])</span>
</pre></div>
</div>
<p>Constraints are then added; note that we are after a target first eigenfrequeccy of 0.22 Hz:</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;FrameOut.Frameouts_outs.Freqs[0] &gt;=0.22&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;max(Utilization.tower_utilization.GLUtil) &lt;=1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;max(Utilization.tower_utilization.EUshUtil) &lt;=1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Utilization.jacket_utilization.t_util &lt;=1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Utilization.jacket_utilization.cb_util &lt;=1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Utilization.jacket_utilization.KjntUtil &lt;= 1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Utilization.jacket_utilization.XjntUtil &lt;= 1.0&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;wbase &lt;= 30.&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;leginputs.Dleg[0]/leginputs.tleg[0] &gt;= 22.&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Xbrcinputs.Dbrc[0]/Xbrcinputs.tbrc[0] &gt;= 22.&#39;</span><span class="p">)</span>
        <span class="n">myjckt</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s">&#39;Mbrcinputs.Dbrc_mud/Mbrcinputs.tbrc_mud &gt;= 22.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A recorder is added to display each iteration to the screen.</p>
<div class="highlight-python"><div class="highlight"><pre>        <span class="n">myjckt</span><span class="o">.</span><span class="n">recorders</span> <span class="o">=</span> <span class="p">[</span><span class="n">DumpCaseRecorder</span><span class="p">(</span><span class="s">&#39;optimization.dat&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>Now the optimization can be run.</p>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">myjckt</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>THe final configuration skeleton is shown in <a href=".html#jacket_tower_tutopt">Figure </a><tt class="xref num docutils literal"><span class="pre">Figure</span> <span class="pre">#jacket_tower_tutOpt</span></tt>.
If you plot the utilization of the tower, you should get something as in <a class="pageref" href="#utilopt-fig">Figure  4</a>, where
the Von Mises stress, global and shell buckling utilizations are shown along the tower span.  Each is a utilization and so should be &lt;1 for feasibility.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;7 nodes in the constant-OD segment of the tower</span>
<span class="go">&gt;&gt;&gt;(&#39;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  needed embedment Lp0=&#39;, 41.880993761055052)</span>
<span class="go">&gt;&gt;&gt;First two Freqs.= 0.2143 and 0.2154 Hz</span>
<span class="go">&gt;&gt;&gt;jacket+TP(structural+lumped) mass (no tower, no piles) [kg] = 1135683</span>
<span class="go">&gt;&gt;&gt;tower mass [kg] = 396546</span>
<span class="go">&gt;&gt;&gt;TP mass structural + lumped mass [kg] = 347611</span>
<span class="go">&gt;&gt;&gt;piles (all) mass (for assigned (not optimum) Lp [kg] =  94910</span>
<span class="go">&gt;&gt;&gt;frame3dd model mass (structural + TP lumped) [kg] = 1532229</span>
<span class="go">&gt;&gt;&gt;Tower Top Displacement in Global Coordinate System [m] =0.4437</span>
<span class="go">&gt;&gt;&gt;MAX member compression-bending utilization at joints = 0.5559</span>
<span class="go">&gt;&gt;&gt;MAX member tension utilization at joints = 0.6590</span>
<span class="go">&gt;&gt;&gt;MAX X-joint  utilization at joints = 0.2586</span>
<span class="go">&gt;&gt;&gt;MAX K-joint  utilization at joints = 0.3807</span>
</pre></div>
</div>
<p>The total mass of the jacket, tower, and TP (both structural and lumped mass), and piles is 1,627,139 kg.
Also note that the first natural frequencies do NOT match the requirement &gt;0.22 Hz.</p>
<div class="figure align-center" id="jacket-tower-tutopt-fig">
<a class="reference internal image-reference" href="_images/jacket_tower_tutOpt.png"><img alt="_images/jacket_tower_tutOpt.png" src="_images/jacket_tower_tutOpt.png" style="width: 6in;" /></a>
<p class="caption">Figure 3: Figure 3: Jacket-tower structure for the tutorial example after OpenMDAO driven optimization via SNOPT.</p>
</div>
<div class="figure align-center" id="utilopt-fig">
<a class="reference internal image-reference" href="_images/util_tutOpt.png"><img alt="_images/util_tutOpt.png" src="_images/util_tutOpt.png" style="width: 6in;" /></a>
<p class="caption">Figure 4: Figure 4: Utilization along tower height for: Von-Mises/yield; shell buckling; global buckling. Optimization obtained via OpenMDAO pyOPT driver with SNOPT.</p>
</div>
</div>
<div class="section" id="jacket-tower-optimization-external-optimization-via-pyopt">
<span id="my-reference-label"></span><h2>5.3. Jacket-Tower Optimization - External Optimization via PyOPT<a class="headerlink" href="#jacket-tower-optimization-external-optimization-via-pyopt" title="Permalink to this headline">¶</a></h2>
<p>For this tutorial, we use an auxiliary module <em>JacketOpt_PyOPT.py</em> and the auxiliary input file <em>MyJacketInputs.py</em>.
The new module is just a wrapper for jacketSE and contains: calls to the pyOPT optimization package to perform the optimization,
objective function and constraints. The input file contains the same jacket input information as in the previous example.</p>
<p>We simply run a SNOPT optimization case by issuing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;python JacketOpt_PyOPT.py MyJacketInputs.py True</span>
</pre></div>
</div>
<p>The run terminates with the following results:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;7 nodes in the constant-OD segment of the tower</span>
<span class="go">&gt;&gt;&gt;(&#39;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  needed embedment Lp0=&#39;, 27.634632160831377)</span>
<span class="go">&gt;&gt;&gt;Jwrapper SOLUTION: bat= 9.48, Dpile= 2.45, tpile=0.025, Lp= 27.6 Dleg 1.14, tleg0.032</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="n">dck_width</span> <span class="o">=</span><span class="mf">12.76</span><span class="p">,</span>    <span class="n">Dbrc</span><span class="o">=</span> <span class="mf">1.00</span><span class="p">,</span> <span class="n">tbrc</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">Dmudbrc</span><span class="o">=</span> <span class="mf">1.00</span><span class="p">,</span> <span class="n">tmudbrc</span><span class="o">=</span><span class="mf">0.025</span>
<span class="go">&gt;&gt;&gt;from Jwrapper Db= 6.38, DTRb=139.88, Dt= 3.21, DTRt=139.88,H2twrfrac= 0.25, Dgir= 1.00,tgir=0.025, Twrmass=413487.941, PilesMass =187056.839, TPmass= 1.424e+05, Frame3DD+Piles Totmass=1477428.623</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;Minimum mass Mjacket, MPiles, TPmass = 1290371.783880 187056.839229 142411.694364</span>
<span class="go">&gt;&gt;&gt;Minimum mass Tower, Jacket(no tower no piles) = 413487.941068 876883.842813</span>
<span class="go">&gt;&gt;&gt;Minimum found at Dpile=2.451534, tpile=0.025400  Lp=27.634661</span>
<span class="go">&gt;&gt;&gt;Minimum found at Dbrc=1.000000, tbrc=0.025400</span>
<span class="go">&gt;&gt;&gt;Minimum found at Dbrcmud=1.000000, tbrcmud=0.025400</span>
<span class="go">&gt;&gt;&gt;Minimum found at batter=9.476407, dckwidth=12.758457, Dleg=1.138723, tleg=0.031565,</span>
<span class="go">&gt;&gt;&gt;Minimum found at Dgir=1.000084, tgir=0.025400</span>
<span class="go">&gt;&gt;&gt;Minimum found at Db=6.379229 DTRb=139.882073 Dt=3.208883 DTRt=139.882073 H2frac=0.250000</span>
<span class="go">&gt;&gt;&gt;Minimum found at Freq 0.220003</span>
<span class="go">&gt;&gt;&gt;Minimum found at GLutil=0.734957 EUutil=0.195177</span>
<span class="go">&gt;&gt;&gt;Minimum found at Mudline Footprint=20.758694</span>
<span class="go">&gt;&gt;&gt;Elapsed time:  4514.93799996 seconds</span>
<span class="go">&gt;&gt;&gt;Execution count:  3422</span>
</pre></div>
</div>
<p>The total mass of the jacket, tower, and TP (both structural and lumped mass), and piles is  1,677,428 kg.
Note that in this case the frequency constraint is met.</p>
<div class="figure align-center" id="jacket-extpysnopt-fig">
<a class="reference internal image-reference" href="_images/jacket_ExtPySnopt.png"><img alt="_images/jacket_ExtPySnopt.png" src="_images/jacket_ExtPySnopt.png" style="width: 6in;" /></a>
<p class="caption">Figure 5: Figure 5: Jacket-tower structure for the tutorial example after OpenMDAO driven optimization via SNOPT.</p>
</div>
<div class="figure align-center" id="utilextopt-fig">
<a class="reference internal image-reference" href="_images/util_ExtPySnopt.png"><img alt="_images/util_ExtPySnopt.png" src="_images/util_ExtPySnopt.png" style="width: 6in;" /></a>
<p class="caption">Figure 6: Figure 6: Utilization along tower height for: Von-Mises/yield; shell buckling; global buckling. Optimization obtained via pyOPT SNOPT.</p>
</div>
</div>
<div class="section" id="jacket-tower-optimization-external-optimization-via-python-cobyla">
<h2>5.4. Jacket-Tower Optimization - External Optimization via Python Cobyla<a class="headerlink" href="#jacket-tower-optimization-external-optimization-via-python-cobyla" title="Permalink to this headline">¶</a></h2>
<p>For this tutorial, we use an auxiliary module <em>JacketOpt_ExtCobyla.py</em> and the same auxiliary input file <em>MyJacketInputs.py</em> as above.
The new module is just a wrapper for jacketSE and contains: calls to the python function <em>scipy.optimize.fmin_cobyla</em> to perform the optimization,
objective function and constraints. The input file contains the same jacket input information as in the previous example.</p>
<p>We start by simply running:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;python JacketOpt_ExtCobyla.py MyJacketInputs.py</span>
</pre></div>
</div>
<p>The run terminates with the following results:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;7 nodes in the constant-OD segment of the tower</span>
<span class="go">&gt;&gt;&gt;(&#39;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  needed embedment Lp0=&#39;, 46.965381137541016)</span>
<span class="go">&gt;&gt;&gt;Jwrapper SOLUTION: bat=15.00, Dpile= 1.00, tpile=0.025, Lp= 47.0 Dleg 1.50, tleg 0.025</span>
<span class="gp">&gt;&gt;&gt; </span>           <span class="n">dck_width</span> <span class="o">=</span><span class="mf">13.92</span><span class="p">,</span> <span class="n">Dbrc</span><span class="o">=</span> <span class="mf">1.00</span><span class="p">,</span> <span class="n">tbrc</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">Dmudbrc</span><span class="o">=</span> <span class="mf">1.00</span><span class="p">,</span> <span class="n">tmudbrc</span><span class="o">=</span><span class="mf">0.025</span>
<span class="go">&gt;&gt;&gt;from Jwrapper Db= 6.96, DTRb=200.00, Dt= 3.62, DTRt=200.00,H2twrfrac= 0.25, Dgir= 1.00,tgir=0.025, Twrmass=349424.881, PilesMass =127705.311, TPmass= 1.353e+05, Frame3DD+Piles Totmass=1330334.683</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;Minimum mass Mjacket, MPiles, TPmass = 1202629.371883 127705.310878 135269.829145</span>
<span class="go">&gt;&gt;&gt;Minimum mass Tower, Jacket(no tower no piles) = 349424.880736 853204.491147</span>
<span class="go">&gt;&gt;&gt;Minimum found at Dpile=1.000000, tpile=0.025400  Lp=46.965381</span>
<span class="go">&gt;&gt;&gt;Minimum found at Dbrc=1.000000, tbrc=0.025400</span>
<span class="go">&gt;&gt;&gt;Minimum found at Dbrcmud=1.000000, tbrcmud=0.025400</span>
<span class="go">&gt;&gt;&gt;Minimum found at batter=15.000000, dckwidth=13.921647, Dleg=1.497250, tleg=0.025400,</span>
<span class="go">&gt;&gt;&gt;Minimum found at Dgir=1.000000, tgir=0.025400</span>
<span class="go">&gt;&gt;&gt;Minimum found at Db=6.960824 DTRb=200.000000 Dt=3.620849 DTRt=200.000000 H2frac=0.250000</span>
<span class="go">&gt;&gt;&gt;Minimum found at Freq 0.220000</span>
<span class="go">&gt;&gt;&gt;Minimum found at GLutil=0.679969 EUutil=0.291541</span>
<span class="go">&gt;&gt;&gt;Minimum found at Mudline Footprint=17.809106 beta3D=54.979833</span>
</pre></div>
</div>
<p>The overall mass (jacket, tower, TP (structural and lumped mass), and piles amounts to 1,530,334 kg, which is less than the optimum found in the previous optimizations.</p>
<p>Cobyla seems to perform better than the other optimization options.</p>
<blockquote id="jacketopt-cobyoptconfig-fig">
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/JacketOpt_CobyOptConfig.png"><img alt="_images/JacketOpt_CobyOptConfig.png" src="_images/JacketOpt_CobyOptConfig.png" style="width: 6in;" /></a>
<p class="caption">Figure 7: Figure 7: Jacket-tower structure for the tutorial example after OpenMDAO driven optimization via SNOPT.</p>
</div>
</div></blockquote>
<blockquote id="util-tutcobyopt-fig">
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/util_tutCobyOpt.png"><img alt="_images/util_tutCobyOpt.png" src="_images/util_tutCobyOpt.png" style="width: 6in;" /></a>
<p class="caption">Figure 8: Figure 8: Utilization along tower height for: Von-Mises/yield; shell buckling; global buckling. Optimization obtained via fmin_cobyla.</p>
</div>
</div></blockquote>
</div>
<div class="section" id="jacket-tower-optimization-optimization-via-openmdaos-cobyla-non-pyopt">
<h2>5.5. Jacket-Tower Optimization - Optimization via OpenMDAOs Cobyla (non-PyOPT)<a class="headerlink" href="#jacket-tower-optimization-optimization-via-openmdaos-cobyla-non-pyopt" title="Permalink to this headline">¶</a></h2>
<p>For this tutorial, we repeat what was done in Section <a class="reference internal" href="#mdaosnopt-label"><em>Jacket-Tower Optimization - OpenMDAO Internal Optimization Driver</em></a>
and this time use the simple COBYLAdriver, not the PyOPTdriver.
The input file contains the same jacket input information as in the previous example.</p>
<p>We start by simply running:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="go">&gt;&gt;&gt;python jacket.py True Cobyla</span>
</pre></div>
</div>
<p>The run terminates with the following results:</p>
<div class="highlight-python"><div class="highlight"><pre>&gt;&gt;&gt;
&gt;&gt;&gt;   Return from subroutine COBYLA because the MAXFUN limit has been reached.
&gt;&gt;&gt;
&gt;&gt;&gt;   NFVALS =    2000   F = 1.450805E+00    MAXCV = 1.500592E-06
&gt;&gt;&gt;   X = 1.204965E+01   1.494575E+00   2.540000E-02   3.000000E+01   1.488532E+00
&gt;&gt;&gt;       2.540000E-02   1.000000E+00   2.540000E-02   1.000000E+00   2.540000E-02
&gt;&gt;&gt;       6.194941E+00   1.300558E+02   3.144349E+00   1.500515E+02   2.500000E-01
&gt;&gt;&gt;First two Freqs.= 0.2200 and 0.2211 Hz
&gt;&gt;&gt;jacket+TP(structural+lumped) mass (no tower, no piles) [kg] = 1130736
&gt;&gt;&gt;tower mass [kg] = 410342
&gt;&gt;&gt;TP mass structural + lumped mass [kg] = 346367
&gt;&gt;&gt;piles (all) mass (for assigned (not optimum, unless optimization is run) Lp [kg] = 109657
&gt;&gt;&gt;frame3dd model mass (structural + TP lumped) [kg] = 1541078
&gt;&gt;&gt;frame3dd model mass (structural + TP lumped) + Pile Mass [kg] = 1650735
&gt;&gt;&gt;Tower Top Displacement in Global Coordinate System [m] =0.4146
&gt;&gt;&gt;MAX member compression-bending utilization at joints = 0.5647
&gt;&gt;&gt;MAX member tension utilization at joints = 0.6596
&gt;&gt;&gt;MAX X-joint  utilization at joints = 0.2544
&gt;&gt;&gt;MAX K-joint  utilization at joints = 0.3807
</pre></div>
</div>
<p>The overall mass (jacket, tower, TP (structural and lumped mass), and piles amounts to 1,650,735 kg, which is still greater than the optimum found with teh external Cobyla, however, the maximum number of iterations was reached in this case.</p>
<p>Cobyla seems to perform better than the other optimization options.</p>
<blockquote id="jacketopt-mdaocobyconfig-fig">
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/jacketOpt_MDAOCobyConfig.png"><img alt="_images/jacketOpt_MDAOCobyConfig.png" src="_images/jacketOpt_MDAOCobyConfig.png" style="width: 6in;" /></a>
<p class="caption">Figure 9: Figure 9: Jacket-tower structure for the tutorial example after OpenMDAO driven optimization via COBYLA driver.</p>
</div>
</div></blockquote>
<blockquote id="util-tutmdaocoby-fig">
<div><div class="figure align-center">
<a class="reference internal image-reference" href="_images/util_tutMDAOCoby.png"><img alt="_images/util_tutMDAOCoby.png" src="_images/util_tutMDAOCoby.png" style="width: 6in;" /></a>
<p class="caption">Figure 10: Figure 10: Utilization along tower height for: Von-Mises/yield; shell buckling; global buckling. Optimization obtained via MDAO COBYLA driver.</p>
</div>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5. Tutorial</a><ul>
<li><a class="reference internal" href="#mw-jacket-tower-in-30-m-waters">5.1. 5-MW Jacket Tower in 30 m Waters</a></li>
<li><a class="reference internal" href="#jacket-tower-optimization-openmdao-internal-optimization-driver">5.2. Jacket-Tower Optimization - OpenMDAO Internal Optimization Driver</a></li>
<li><a class="reference internal" href="#jacket-tower-optimization-external-optimization-via-pyopt">5.3. Jacket-Tower Optimization - External Optimization via PyOPT</a></li>
<li><a class="reference internal" href="#jacket-tower-optimization-external-optimization-via-python-cobyla">5.4. Jacket-Tower Optimization - External Optimization via Python Cobyla</a></li>
<li><a class="reference internal" href="#jacket-tower-optimization-optimization-via-openmdaos-cobyla-non-pyopt">5.5. Jacket-Tower Optimization - Optimization via OpenMDAOs Cobyla (non-PyOPT)</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="theory.html"
                        title="previous chapter">4. Theory</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="theory.html" title="4. Theory"
             >previous</a> |</li>
        <li><a href="index.html">jacketse 1.0. documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, RRD.
      Last updated on Nov 04, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>